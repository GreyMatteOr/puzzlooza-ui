(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{48:function(t,e,n){},80:function(t,e,n){},81:function(t,e,n){},85:function(t,e,n){},86:function(t,e,n){"use strict";n.r(e);var r,o=n(0),i=n(9),c=n(10),a=n(12),s=n(11),l=(n(48),n(43)),u=n.n(l),d=n(45),p=n(1),f=n.n(p),h=(n(80),n.p+"static/media/rainbow.ccc2084b.jpg"),g=n(13),v=n(6),m=!1,b={},j=void 0!==window.ontouchstart,y=function(t,e,n,r,o){m||document.addEventListener(j?"touchmove":"mousemove",(function(t){var e=t;t.touches&&(e=t.touches[0]),Object.entries(b).forEach((function(t){var n=Object(g.a)(t,2);n[0];(0,n[1])(e.clientX,e.clientY)}))})),m=!0;var i=!1,c=!1,a=0,s=0,l=0,u=0;function d(e){if(e.stopPropagation(),e.preventDefault(),"false"!==t.dataset.dragEnabled){var n=e;e.touches&&(n=e.touches[0]),i=!0,a=t.offsetLeft-n.clientX,s=t.offsetTop-n.clientY}}return e.addEventListener(j?"touchstart":"mousedown",d),t.addEventListener(j?"touchend":"mouseup",(function(){i=!1,c=!1,o&&o(t,e,parseInt(t.style.left),parseInt(t.style.top))})),b[e.id]=function(e,o){if(i){if(c||(c=!0,r&&r(t,l,u)),l=e+a,u=o+s,"true"===t.dataset.dragBoundary){if(l<1||l>=window.innerWidth-t.offsetWidth)return;if(u<1||u>=window.innerHeight-t.offsetHeight)return}t.style.left=l+"px",t.style.top=u+"px",n.emit("move",t.id,l+"px",u+"px")}},function(t){t.removeEventListener("mousedown",d),delete b[t.id]}},O=(n(81),function(t){Object(a.a)(n,t);var e=Object(s.a)(n);function n(t){var r;return Object(i.a)(this,n),(r=e.call(this,t)).checkMatch=function(t,e,n){var o,i=t.offsetHeight,c=t.offsetWidth,a=e+(parseInt(t.style.gridColumn)-1)*c,s=n+(parseInt(t.style.gridRow)-1)*i,l={bottom:{shoveXY:[null,s+i+3],refNames:["bBL","bBR"]},left:{shoveXY:[a-c-3,null],refNames:["lBL","lTL"]},right:{shoveXY:[a+c+3,null],refNames:["rBR","rTR"]},top:{shoveXY:[null,s-i-3],refNames:["tTL","tTR"]}},u={bBL:[a+.2*c,s+(i+3)],bBR:[a+.8*c,s+(i+3)],center:[a+.5*c,s+.5*i],lBL:[a-3,s+.8*i],lTL:[a-3,s+.2*i],rBR:[a+c+1,s+.8*i],rTR:[a+c+1,s+.2*i],tTL:[a+.2*c,s-1],tTR:[a+.8*c,s-1]},d=(o=document).elementsFromPoint.apply(o,Object(v.a)(u.center));["bottom","left","right","top"].forEach((function(e){var n,o,i=l[e],c=i.shoveXY,a=i.refNames,s=u[a[0]],p=u[a[1]],f=(n=document).elementsFromPoint.apply(n,Object(v.a)(s)),h=(o=document).elementsFromPoint.apply(o,Object(v.a)(p));(f=f.filter((function(n,o){var i=h.indexOf(n);if(i>=0){var a;if(d.includes(n))(a=r).shove.apply(a,[n].concat(Object(v.a)(c)));else n.classList.contains("tile")&&r.grouping.current.id!==n.parentNode.id&&t.dataset[e]===n.id&&r.join(t,n.parentNode);return h.splice(i,1),!1}return!0}))).concat(h).forEach((function(t){var e;return(e=r).shove.apply(e,[t].concat(Object(v.a)(c)))}))}))},r.checkOverlap=function(t,e,n,o,i){var c,a=[n+.5*e,o+.5*t],s=[[n,o+t+3],[n-e-3,o],[n+e+3,o],[n,o-t-3]];(c=document).elementsFromPoint.apply(c,a).forEach((function(t){if(t.id!==i){var e,n=Math.floor(Math.random()*s.length),o=s[n];(e=r).shove.apply(e,[t].concat(Object(v.a)(o)))}}))},r.join=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n&&r.props.client.emit("combine",r.grouping.current.id,e.id,t.id);var o=parseInt(t.style.gridColumn),i=parseInt(t.style.gridRow),c=parseInt(t.parentNode.style.left),a=parseInt(t.parentNode.style.top),s=t.id.split(",").map((function(t){return parseInt(t)})),l=Object(g.a)(s,2),u=l[0],d=l[1];Object(v.a)(e.children).forEach((function(t){for(var n=t.id.split(",").map((function(t){return parseInt(t)})),c=Object(g.a)(n,2),a=c[0],s=c[1],l=a-u+o,p=s-d+i;l<1;)r.tiles.forEach((function(t){return t.unshift(null)})),l++,o++;for(;p<1;){var f=new Array(r.tiles[0].length).fill(null);r.tiles.unshift(f),p++,i++}for(;l>r.tiles[0].length;)r.tiles.forEach((function(t){return t.push(null)}));for(;p>r.tiles.length;){var h=new Array(r.tiles[0].length).fill(null);r.tiles.push(h)}r.tiles[p-1][l-1]=t,r.grouping.current.append(e.removeChild(t)),r.unregister(t),y(r.grouping.current,t,r.props.client,(function(){return r.grouping.current.style.zIndex=1}),(function(t,e,n,o){r.checkMatch(e,n,o),r.grouping.current.style.zIndex=0}))})),r.canvas.current.style.gridColumn=o,r.canvas.current.style.gridRow=i,r.updateGrid(t,r.tiles,c,a),r.props.delete(e.id)},r.canvas=f.a.createRef(),r.grouping=r.props.groupRef,r.tiles=[],r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.drawTile(this.canvas.current),this.props.funcElevator(this.grouping.current.id,this.join),this.tiles.push([this.canvas.current]),this.unregister=y(this.grouping.current,this.canvas.current,this.props.client,(function(){return t.grouping.current.style.zIndex=2}),(function(e,n,r,o){isNaN(r)&&(r=1),isNaN(o)&&(o=1),t.grouping.current.style.zIndex=0,t.checkMatch(n,r,o)}))}},{key:"drawTile",value:function(t){var e=t.getContext("2d"),n=this.props,r=n.dx,o=n.dy,i=n.image,c=n.x,a=n.y;e.drawImage(i,c,a,r,o,0,0,300,150)}},{key:"shove",value:function(t,e,n){var r=this;if(t.classList.contains("tile")&&this.grouping.current.id!==t.parentNode.id){var o=t.parentNode,i=window.innerWidth-o.offsetWidth,c=window.innerHeight-o.offsetHeight,a=parseInt(o.style.left)||1,s=parseInt(o.style.top)||1;e=null===e?a:Math.min(Math.max(e,1),i),n=null===n?s:Math.min(Math.max(n,1),c),o.style.top=n+"px",o.style.left=e+"px",window.setTimeout((function(){return r.checkOverlap(o.offsetHeight,o.offsetWidth,e,n,t.id)}),0)}}},{key:"updateGrid",value:function(t,e,n,r){for(var o=0;o<e.length;o++)for(var i=0;i<e[0].length;i++){var c=e[o][i];null!==c&&(c.style.gridColumn=i+1,c.style.gridRow=o+1)}var a=this.grouping.current.style;a.gridTemplateColumns=e[0].length,a.gridTemplateRows=e.length,a.height=100*e.length+"px",a.left=n-100*(parseInt(t.style.gridColumn)-1)+"px",a.top=r-100*(parseInt(t.style.gridRow)-1)+"px",a.width=100*e[0].length+"px"}},{key:"render",value:function(){var t=this.props.coordinates.split(",").map((function(t){return parseInt(t)})),e=Object(g.a)(t,2),n=e[0],r=e[1];return Object(o.jsx)("div",{className:"canvas-grouping","data-drag-boundary":"true",id:"".concat(n,"-").concat(r),ref:this.grouping,style:{display:"grid",gridTemplateColumns:"1",gridTemplateRows:"1"},children:Object(o.jsx)("canvas",{className:"tile","data-bottom":"".concat(n,",").concat(r+1),"data-left":"".concat(n-1,",").concat(r),"data-right":"".concat(n+1,",").concat(r),"data-top":"".concat(n,",").concat(r-1),id:this.props.coordinates,ref:this.canvas,style:{gridColumn:"1",gridRow:"1"}})})}}]),n}(p.Component)),x=function(t){Object(a.a)(n,t);var e=Object(s.a)(n);function n(t){var r;return Object(i.a)(this,n),(r=e.call(this,t)).createTiles=function(t,e,n){for(var i,c,a=n.width,s=n.height,l=Math.floor(a/t),u=Math.floor(s/e),d=a%l,p=s%u,h={},g=0;g<e;g++)for(var v=0;v<t;v++){var m=f.a.createRef();d&&(i=v,d--),p&&(c=g,p--),r.tileRefs["".concat(v,"-").concat(g)]=m,h["".concat(v,"-").concat(g)]=Object(o.jsx)(O,{client:r.props.client,coordinates:"".concat(v,",").concat(g),delete:r.delete,dx:l,dy:u,funcElevator:r.saveTileCombiner,image:n,groupRef:m,x:v*l+i,y:g*u+c},"".concat(v,",").concat(g))}r.setState({tiles:h})},r.delete=function(t){var e=Object(d.a)({},r.state.tiles);delete e[t],r.setState({tiles:e})},r.doneLoadingPic=function(t){r.createTiles(9,6,t.target),r.setState({loadingPicture:!1}),r.props.client.on("combine",(function(t,e,n){return r.combineGroups(t,e,n)})),r.props.client.on("move",(function(t,e,n){return r.moveGroup(t,e,n)}))},r.combineGroups=function(t,e,n){var o=r.tileCombiners[t],i=r.tileRefs[e];o(document.getElementById(n),i.current,!1)},r.moveGroup=function(t,e,n){var o=r.tileRefs[t];o.current.style.left=e,o.current.style.top=n},r.saveTileCombiner=function(t,e){r.tileCombiners[t]=e},r.state={loadingPicture:!0,tiles:{}},r.tileCombiners={},r.tileRefs={},r}return Object(c.a)(n,[{key:"render",value:function(){if(this.state.loadingPicture){var t=Object(o.jsx)("img",{src:h,onLoad:this.doneLoadingPic});return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("h1",{children:"Loading"}),t]})}return Object(o.jsx)(o.Fragment,{children:Object.values(this.state.tiles)})}}]),n}(p.Component),w=function(t){Object(a.a)(n,t);var e=Object(s.a)(n);function n(t){var o;return Object(i.a)(this,n),(o=e.call(this,t)).componentDidMount=function(){r=u.a.connect("https://puzzlooza.herokuapp.com/"),console.log("Attempting to connect..."),r.on("connect",(function(t){console.log("Connected to server."),o.setState({connected:!0})}))},o.state={connected:!1},o}return Object(c.a)(n,[{key:"render",value:function(){return this.state.connected?Object(o.jsx)("div",{className:"App",children:Object(o.jsx)(x,{client:r})}):Object(o.jsx)("h1",{children:"Connecting to server..."})}}]),n}(p.Component),R=n(44),I=n.n(R);n(85);I.a.render(Object(o.jsx)(f.a.StrictMode,{children:Object(o.jsx)(w,{})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.7493795f.chunk.js.map